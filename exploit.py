import requests
import time

url = "http://localhost:5001/"
payload = "thequickbrownfoxjumpsoverthelazydog"
flag = "CTF{YoUMadeIt}"

print(f"[+] Sending exploit payload: {payload}")
try:
    r = requests.post(url, data={"username": payload}, timeout=2)
    if r.status_code == 500:
        print("\n[+] Crash detected! Exploit successful, simulating shell access...")
        time.sleep(1)
        print("\n[appuser@lab ~]$ whoami")
        time.sleep(0.5)
        print("appuser")
        time.sleep(0.5)
        print("[appuser@lab ~]$ cat flag.txt")
        time.sleep(0.5)
        print(flag)
        print("\n[+] Flag captured above.")
    else:
        print("\n[-] Exploit failed. No crash detected.")
except Exception as e:
    print(f"\n[!] Error during exploit: {e}")
